{"ast":null,"code":"/*\n * Copyright (c) 2017-2018 Aion foundation.\n *\n *     This file is part of the aion network project.\n *\n *     The aion network project is free software: you can redistribute it \n *     and/or modify it under the terms of the GNU General Public License \n *     as published by the Free Software Foundation, either version 3 of \n *     the License, or any later version.\n *\n *     The aion network project is distributed in the hope that it will \n *     be useful, but WITHOUT ANY WARRANTY; without even the implied \n *     warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  \n *     See the GNU General Public License for more details.\n *\n *     You should have received a copy of the GNU General Public License\n *     along with the aion network project source files.  \n *     If not, see <https://www.gnu.org/licenses/>.\n *\n * Contributors:\n *     Aion foundation.\n *     Fabian Vogelsteller <fabian@frozeman.de>\n */\n\"use strict\";\n\nvar givenProvider = null; // ADD GIVEN PROVIDER\n\n/* jshint ignore:start */\n\nvar global = Function('return this')(); // EthereumProvider\n\nif (typeof global.ethereumProvider !== 'undefined') {\n  givenProvider = global.ethereumProvider; // Legacy web3.currentProvider\n} else if (typeof global.web3 !== 'undefined' && global.web3.currentProvider) {\n  if (global.web3.currentProvider.sendAsync) {\n    global.web3.currentProvider.send = global.web3.currentProvider.sendAsync;\n    delete global.web3.currentProvider.sendAsync;\n  } // if connection is 'ipcProviderWrapper', add subscription support\n\n\n  if (!global.web3.currentProvider.on && global.web3.currentProvider.connection && global.web3.currentProvider.connection.constructor.name === 'ipcProviderWrapper') {\n    global.web3.currentProvider.on = function (type, callback) {\n      if (typeof callback !== 'function') throw new Error('The second parameter callback must be a function.');\n\n      switch (type) {\n        case 'data':\n          this.connection.on('data', function (data) {\n            var result = '';\n            data = data.toString();\n\n            try {\n              result = JSON.parse(data);\n            } catch (e) {\n              return callback(new Error('Couldn\\'t parse response data' + data));\n            } // notification\n\n\n            if (!result.id && result.method.indexOf('_subscription') !== -1) {\n              callback(null, result);\n            }\n          });\n          break;\n\n        default:\n          this.connection.on(type, callback);\n          break;\n      }\n    };\n  }\n\n  givenProvider = global.web3.currentProvider;\n}\n/* jshint ignore:end */\n\n\nmodule.exports = givenProvider;","map":null,"metadata":{},"sourceType":"script"}